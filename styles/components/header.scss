@use '/styles/core/core' as *;

//***********************************************************************
//  Transition
//***********************************************************************
.header-enter,
.header-exit {
    @include transition(transform);
    will-change: transform;
    transform: translateY(-100%);
}

.header-enter-active {
    transform: none;
}

.header-nav-enter,
.header-nav-exit {
    @include transition(opacity);
    will-change: opacity;
    opacity: 0;
}
.header-nav-enter-active {
    opacity: 1;
}

//***********************************************************************
//  Base
//***********************************************************************
body.header-fixed-top {
    #app,
    #__next,
    #__nuxt {
        padding-top: $header-height-sm;

        #visual {
            margin-top: -$header-height-sm;
        }

        @include breakpoint-up {
            padding-top: $header-height;

            #visual {
                margin-top: -$header-height;
            }
        }
    }
}

#header {
    user-select: none;
    position: relative;
    z-index: $zindex-bar;

    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 calc($grid-gutter-width / 2);
    height: $header-height-sm;

    @include transition((background, box-shadow));

    @include breakpoint-up {
        padding: 0 $grid-gutter-width;
        height: $header-height;
    }

    .header-fixed-top & {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
    }

    @include hover-mouse {
        background-color: $header-bg;
        box-shadow: $box-shadow-dark;

        @include darkmode {
            background-color: $dark-header-bg;
        }
    }

    &.show-bg {
        background-color: $header-bg;
        box-shadow: $box-shadow-dark;

        @include darkmode {
            background-color: $dark-header-bg;
        }
    }
}

#header-logo {
    flex: 0 0 auto;
    height: 100%;

    a {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;

        &:hover {
            text-decoration: none;
        }
    }

    img {
        vertical-align: top;
        width: auto;
        height: $header-height-sm * 0.25;

        @include breakpoint-up {
            height: $header-height * 0.25;
        }
    }
}

//***********************************************************************
//  Hamburger
//***********************************************************************
$hbg-line-gap: 4px;
$hbg-line-weight: 2px;
$hbg-width: 24px;
$hbg-height: ($hbg-line-weight * 3) + ($hbg-line-gap * 2);
$hbg-trans: calc(($hbg-height / 2) - ($hbg-line-weight / 2));

#hamburger {
    @include button-reset;
    width: $header-height-sm;
    height: $header-height-sm;
    margin-right: calc(($header-height-sm - $hbg-width) / -2);

    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;

    @include breakpoint-up {
        width: $header-height;
        height: $header-height;
        margin-right: calc(($header-height - $hbg-width) / -2);
    }
}

#hamburger-icon {
    position: relative;
    display: block;

    width: $hbg-width;
    height: $hbg-line-weight;
    background-color: $headings-color;
    @include transition(background);

    @include darkmode {
        background-color: $dark-headings-color;
    }

    &::before,
    &::after {
        content: '';
        width: 100%;
        height: $hbg-line-weight;
        background-color: $headings-color;
        position: absolute;
        left: 0;
        @include transition(transform);

        @include darkmode {
            background-color: $dark-headings-color;
        }
    }

    &::before {
        top: -($hbg-line-gap + $hbg-line-weight);
    }

    &::after {
        bottom: -($hbg-line-gap + $hbg-line-weight);
    }

    #hamburger.active & {
        background-color: transparent;

        &::before {
            transform: translateY($hbg-trans) rotate(45deg);
        }

        &::after {
            transform: translateY(-$hbg-trans) rotate(-45deg);
        }
    }
}

//***********************************************************************
//  Navigation
//***********************************************************************
#header-nav {
    position: fixed;
    z-index: $zindex-sidebar;
    top: $header-height-sm;
    left: 0;
    right: 0;
    height: calc(100% - $header-height-sm);

    background-color: rgba(0,0,0,0.5);
    backdrop-filter: blur(5px);
    font-size: 1rem;

    @include breakpoint-up(lg) {
        background: none;
        backdrop-filter: none;
        position: static;
        width: auto;
        height: auto;
        padding: 0;
        flex: 1 1 auto;
        font-size: 1.285vw;
    }

    @include breakpoint-up(xl) {
        font-size: 1rem;
    }

    nav {
        position: relative;
        z-index: 2;
        overflow-x: hidden;
        overflow-y: auto;

        @include breakpoint-up {
            overflow: visible;
        }
    }

    ul {
        margin: 0;
        padding: 0;
        list-style: none;
        border-top: 1px solid $border-color;
        background-color: $header-bg;

        @include darkmode {
            background-color: $dark-header-bg;
        }

        @include breakpoint-up {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            border: none;
            background: none;
        }

        li {
            border-bottom: 1px solid $border-color;

            @include breakpoint-up {
                border: none;
            }
        }

        a:not(.btn),
        .expansion-toggler {
            position: relative;
            width: 100%;
            display: flex;
            align-items: center;
            padding: calc((spacer(4) - $icon-size) / 2) calc($grid-gutter-width / 2);
            line-height: $icon-size;
            font-size: inherit;
            color: $headings-color;
            white-space: nowrap;
            @include transition((background, color));

            @include focus-mouse {
                color: $link-color;
            }

            @include darkmode {
                color: $dark-headings-color;
            }

            @include breakpoint-up {
                padding: calc(($header-height - $icon-size) / 2) calc($grid-gutter-width / 2);
            }
        }

        .expansion {
            position: relative;

            .expansion-toggler {
                font-size: inherit;

                .icon {
                    color: $link-color;
                }
            }

            .expansion-body {
                @include breakpoint-up {
                    overflow: visible !important;
                    position: absolute;
                    top: 100%;
                    left: 0;
                    min-width: 100%;
                    margin-top: spacer(-1.25);
                }
            }

            &.show {
                .expansion-toggler {
                    color: $link-hover-color;
                }
            }
        }

        .btn {
            font-size: inherit;
            font-weight: normal;

            @include breakpoint-down {
                display: block;
                margin: calc((spacer(4) - $icon-size) / 2) calc($grid-gutter-width / 2);
            }

            @include breakpoint-up {
                margin: 0 spacer(0.5);
                padding: $input-sm-padding-y $btn-padding-x;
            }
        }

        &.navigation-child {
            background-color: $muted-bg;

            @include darkmode {
                background-color: $dark-muted-bg;
            }

            @include breakpoint-up {
                display: block;
                padding: spacer(1);
                background-color: $header-bg;
                box-shadow: $box-shadow-dark;
                @include rounded();

                @include darkmode {
                    background-color: $dark-header-bg;
                }
            }

            li {
                &:last-child {
                    border: none;
                }
            }

            a:not(.btn) {
                padding: calc((spacer(3.5) - $icon-size) / 2) $grid-gutter-width;
                font-size: 0.875em;

                @include breakpoint-up {
                    padding: spacer(1);
                    font-size: 1rem;
                }
            }
        }
    }
}

#header-nav-overlay {
    position: absolute;
    z-index: 1;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    cursor: pointer;
}